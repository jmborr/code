	character*255 namep(25000),name
	character*2 namefiles(99)
	character*3 namefiles3(200)	
	character*4 pdbf
	character*3 pdb
	character*1 namefiles1(9)
        data namefiles1/'1','2','3','4','5','6','7','8','9'/
	data namefiles/'_1','_2','_3','_4','_5','_6','_7','_8','_9',
     &	'10','11','12','13','14','15','16','17','18','19',
     &	'20','21','22','23','24','25','26','27','28','29',
     &	'30','31','32','33','34','35','36','37','38','39',
     &	'40','41','42','43','44','45','46','47','48','49',
     &	'50','51','52','53','54','55','56','57','58','59',
     &	'60','61','62','63','64','65','66','67','68','69',
     &	'70','71','72','73','74','75','76','77','78','79',
     &	'80','81','82','83','84','85','86','87','88','89',
     &	'90','91','92','93','94','95','96','97','98','99'/
	data namefiles3/'100',
     &  '101','102','103','104','105','106','107','108','109',
     &	'110','111','112','113','114','115','116','117','118','119',
     &	'120','121','122','123','124','125','126','127','128','129',
     &	'130','131','132','133','134','135','136','137','138','139',
     &	'140','141','142','143','144','145','146','147','148','149',
     &	'150','151','152','153','154','155','156','157','158','159',
     &	'160','161','162','163','164','165','166','167','168','169',
     &	'170','171','172','173','174','175','176','177','178','179',
     &	'180','181','182','183','184','185','186','187','188','189',
     &	'190','191','192','193','194','195','196','197','198','199',
     &  '200',
     &  '201','202','203','204','205','206','207','208','209',
     &	'210','211','212','213','214','215','216','217','218','219',
     &	'220','221','222','223','224','225','226','227','228','229',
     &	'230','231','232','233','234','235','236','237','238','239',
     &	'240','241','242','243','244','245','246','247','248','249',
     &	'250','251','252','253','254','255','256','257','258','259',
     &	'260','261','262','263','264','265','266','267','268','269',
     &	'270','271','272','273','274','275','276','277','278','279',
     &	'280','281','284','283','284','285','286','287','288','289',
     &	'290','291','292','293','294','295','296','297','298','299'/

     	open(unit=1,file='input')
	read(unit=1,fmt='a4')pdbf
     	open(unit=2,file='input2')
	read(unit=2,fmt='a3')pdb
	open(unit=6,file='out')
	open(unit=11,file='namesize')
	read(11,*)nsize
	close(11)
	open(unit=10,file='listhomol')
	ics=0
	read(10,*)naln
	do id=1,naln
 	read(10,1)name(1:nsize)
	ics=ics+1
	namep(ics)=name(1:nsize)
	end do
	ncs=ics
	write(6,*)ncs
	open(unit=7,file='nruns')
	write(7,*)ncs
	do imv=76,76+ncs-1
	if(imv .gt.9 .and. imv .lt.100)then
	OPEN(unit=30,file='nametarg'//namefiles(imv))
	elseif(imv .lt.10)then
	OPEN(unit=30,file='nametarg'//namefiles1(imv))
	end if
	if(imv .lt. 100)then
	OPEN(unit=20,file='LIST.targ'//pdbf//namefiles(imv))	
	write(30,22)pdbf,namefiles(imv)
22	format(a4,a2)
	else
	iimv=imv-99	
	OPEN(unit=30,file='nametarg'//namefiles3(iimv))
	OPEN(unit=20,file='LIST.targ'//pdb//namefiles3(iimv))	
	write(30,210)pdb,namefiles3(iimv)
210	format(a3,a3)
	end if
	id=1
	write(20,2)id,pdbf
2       format(i3,1x,a4)
	write(20,1)namep(imv-75)
1	format(a)
	end do
	close(20)
	stop
	end 
