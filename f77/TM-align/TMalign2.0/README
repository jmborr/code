This code is second version produced by Yang (not Shashi) 
